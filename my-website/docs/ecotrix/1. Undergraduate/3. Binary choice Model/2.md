# Multinomial Logistic Regression

This section builds upon the concepts discussed in the [Logistic Regression](/Notebooks_Courses/docs/ecotrix/Undergraduate/Binary%20choice%20Model/1) section. In this section we will focus on **Unordered** choices.

## Random Utility Basis

For the $i^{th}$ consumer faced with $J$ choices, the utility of choice $j$ is
$$
U_{ij} = \bold{w'}_i \boldsymbol{\beta}_j + \bold{z'}_{ij}\boldsymbol{\gamma}_j + \varepsilon_{ij}
$$


Variables are defined as follows:
* $U_{ij}:=$ Utility an individual $i$ gets while consuming product $j$.
* $w'_i:=$ Individual $i's$ characteristic like income, sex etc. Note that these characteristics do not vary with products.
* $z'_{ij}:=$ Attributes of product $j$ and some attributes can vary across individuals, eg. Transit time.

If the consumer chooses $j$, then
$$
P[U_{ij}>U_{ik}], \hspace{10px} \forall k\neq j.
$$

### Example

Assume there are 4 choices $\{A,B,C,D\}$. Then the utilities for the $i^{th}$ consumer are given as
$$
\begin{align*}
U_{iA} &= \bold{w'}_i \boldsymbol{\beta}_A + \bold{z'}_{iA}\boldsymbol{\gamma}_A + \varepsilon_{iA}=\bold{V}_{iA}+ \varepsilon_{iA}\\
U_{iB} &= \bold{w'}_i \boldsymbol{\beta}_B + \bold{z'}_{iB}\boldsymbol{\gamma}_B + \varepsilon_{iB}=\bold{V}_{iB}+ \varepsilon_{iB}\\
U_{iC} &= \bold{w'}_i \boldsymbol{\beta}_C + \bold{z'}_{iC}\boldsymbol{\gamma}_C + \varepsilon_{iC}=\bold{V}_{iC}+ \varepsilon_{iC}\\
U_{iD} &= \bold{w'}_i \boldsymbol{\beta}_D + \bold{z'}_{iD}\boldsymbol{\gamma}_D + \varepsilon_{iD}=\bold{V}_{iD}+ \varepsilon_{iD}
\end{align*}
$$

If $i^{th}$ consumer chooses $C$, then
$$
U_{iC}>U_{iA} \text{ and } U_{iC}>U_{iB} \text{ and } U_{iC}>U_{iD}.
$$

This implies,
$$
\begin{align*}
    P[y_i=C]=P_{iC}&=P[U_{iC}>U_{iA} \text{ and } U_{iC}>U_{iB} \text{ and } U_{iC}>U_{iD}]\\
    &=P[U_{iC}-U_{iA}>0 \text{ and } U_{iC}-U_{iB}>0 \text{ and } U_{iC}-U_{iD}>0]
\end{align*}
$$