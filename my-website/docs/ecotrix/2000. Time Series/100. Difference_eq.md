---
sidebar_position: 100
---
# Difference Equations

## First Order Difference Equations

Following equation is the **linear first order difference equation**:
$$
y_t=\phi y_{t-1}+w_t.
$$

## Recursive Solution

Consider the following system

<div style={{ textAlign: 'center' }}>
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Equation</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>0</td>
                <td>$y_0=\phi y_{-1}+w_0$</td>
            </tr>
            <tr>
                <td>1</td>
                <td>$y_1=\phi y_{0}+w_1$</td>
            </tr>
            <tr>
                <td>2</td>
                <td>$y_2=\phi y_{1}+w_2$</td>
            </tr>
            <tr>
                <td>$\vdots$</td>
                <td>$\vdots$</td>
            </tr>
            <tr>
                <td>t</td>
                <td>$y_t=\phi y_{t-1}+w_t$</td>
            </tr>
        </tbody>
    </table>
</div>

Given the initial conditions $y_{-1}$ and $w_0$, we are equipped to determine all future values of $y$.

We can write $y_1$ as 
$$
\begin{align*}
y_1&=\phi y_{0}+w_1\\
&=\phi (\phi y_{-1}+w_0) +w_1\\
&=\phi^2 y_{-1}+ \phi w_0 +w_1.
\end{align*}
$$
Similarly $y_2$ can be written as
$$
\begin{align*}
y_2&=\phi^3 y_{-1}+ \phi^2 w_0 +\phi w_1 + w_2,
\end{align*}
$$
and $y_{100}$ can be written as
$$
y_{100}=\phi^{101}y_{-1}+\phi^{100}w_0 + \phi^{99}w_1 + \cdots+\phi w_{99}+w_{100}.
$$
In general
$$
y_{t}=\phi^{t+1}y_{-1}+\phi^{t}w_0 + \phi^{t-1}w_1 + \cdots+\phi w_{t-1}+w_{t}.
$$
Another general form is
$$
y_{t+j}=\phi^{j+1}y_{t-1}+\phi^{j}w_t + \phi^{j-1}w_{t+1} + \cdots+\phi w_{t+j-1}+w_{t+j}.
$$
Effect of $w_t$ on $y_{t+j}$ is 
$$
\frac{\partial y_{t+j}}{\partial w_t}=\phi^j.
$$
**Points to note:**
1. The above equation is also called **Impulse Response Function (IRF)**.
2. When $|\phi|<1$, the system is stable. When $|\phi|>1$, the system is explosive.

If $|\phi|<1$, the cumulative effect of one unit increase in $w_t$ on $y_{t+j}$, where $j \in \{0,1,2,\cdots\}$, is
$$
\sum_{j=0}^{\infty}\frac{\partial y_{t+j}}{\partial w_t}= \sum_{j=0}^{\infty}\phi ^j = \frac{1}{1-\phi}.
$$

## Example

Let the stream of future values be $\{y_t,y_{t+1},y_{t+2},\cdots\}$ and the interest rate be $r$. Present value (PV) of the stream at time $t$ is given by
$$
PV=y_t+ \frac{y_{t+1}}{1+r}+\frac{y_{t+2}}{(1+r)^2}+\frac{y_{t+3}}{(1+r)^3}+ \cdots
$$
Let $\beta$ be the discount factor, hence
$$
\beta=\frac{1}{1+r}.
$$
Therefore
$$
\begin{align*}
    PV&=y_t+ \beta y_{t+1}+ \beta^2 y_{t+2}+ \beta^3 y_{t+3}+\cdots\\
    &=\sum_{j=0}^{\infty}\beta^j y_{t+j}\\
    \frac{\partial PV}{\partial w_t}&=\sum_{j=0}^{\infty}\beta^j \frac{\partial y_{t+j}}{\partial w_t}\\
    &=\sum_{j=0}^{\infty}\beta^j \phi^j\\
    &=\frac{1}{1-\beta \phi}
\end{align*}
$$
provided $|\beta \phi|<1$.