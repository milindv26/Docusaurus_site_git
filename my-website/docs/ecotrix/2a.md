---
sidebar_position: 3
---
# OLS Inference

First we will talk about some properties of OLS.

## Properties

### OLS estimator is Unbiased

We have
$$
\begin{align*}
    \bold{b}&=\bold{(X'X)}^{-1}\bold{X'y},\\
    &=\bold{(X'X)}^{-1}\bold{X'(X}\boldsymbol{\beta + \varepsilon)},\\
    &=\boldsymbol{\beta} + \bold{(X'X)}^{-1}\bold{X'}\boldsymbol{\varepsilon},\\
\end{align*}
$$
taking expectation both sides, we get
$$
\begin{align*}
    \mathbb{E}[\bold{b|X}]&=\mathbb{E}[\boldsymbol{\beta}|\bold{X}] + \mathbb{E}[\bold{(X'X)}^{-1}\bold{X'}\boldsymbol{\varepsilon}|\bold{X}],\\
    &=\boldsymbol{\beta} + \bold{(X'X)}^{-1}\bold{X'}\underbrace{\mathbb{E}[\boldsymbol{\varepsilon}|\bold{X}]}_{=0},\\
    &= \boldsymbol{\beta}.
\end{align*}
$$

### Variance of OLS estimator

We have
$$
\begin{align*}
    \bold{b}&=\boldsymbol{\beta} + \underbrace{\bold{(X'X)}^{-1}\bold{X'}}_{\bold{A}}\boldsymbol{\varepsilon},\\
    &=\boldsymbol{\beta} + \bold{A}\boldsymbol{\varepsilon},\\
    \implies \bold{b}-\boldsymbol{\beta}&=\bold{A}\boldsymbol{\varepsilon}.
\end{align*}
$$
Since $\bold{b}$ is a vector of dimension $(K \times 1)$
$$
\begin{align*}
    \mathbb{Var}(\bold{b})&=\begin{bmatrix}
\mathbb{Var}(b_0) & \mathbb{Cov}(b_0,b_1) & \mathbb{Cov}(b_0,b_2)&...&\mathbb{Cov}(b_0,b_K)\\
\mathbb{Cov}(b_1,b_0) & \mathbb{Var}(b_1) & \mathbb{Cov}(b_1,b_2)&...&\mathbb{Cov}(b_1,b_K)\\
\mathbb{Cov}(b_2,b_0) & \mathbb{Cov}(b_2,b_1) & \mathbb{Var}(b_2)&...&\mathbb{Cov}(b_2,b_K)\\
.&.&.&...&.\\
.&.&.&...&.\\
.&.&.&...&.\\
\mathbb{Cov}(b_K,b_0) & \mathbb{Cov}(b_K,b_1) & \mathbb{Cov}(b_K,b_2)&...&\mathbb{Var}(b_K)\\
\end{bmatrix}_{(K \times K)},\\
&=
\begin{bmatrix}
\mathbb{E}[(b_0-\beta_0)^2] & \mathbb{E}[(b_0-\beta_0)(b_1-\beta_1)] & \mathbb{E}[(b_0-\beta_0)(b_2-\beta_2)]&...&\mathbb{E}[(b_0-\beta_0)(b_K-\beta_K)]\\
\mathbb{E}[(b_1-\beta_1)(b_0-\beta_0)] & \mathbb{E}[(b_1-\beta_1)^2] & \mathbb{E}[(b_1-\beta_1)(b_2-\beta_2)]&...&\mathbb{E}[(b_1-\beta_1)(b_K-\beta_K)]\\
\mathbb{E}[(b_2-\beta_2)(b_0-\beta_0)] & \mathbb{E}[(b_2-\beta_2)(b_1-\beta_1)] & \mathbb{E}[(b_2-\beta_2)^2]&...&\mathbb{E}[(b_2-\beta_2)(b_K-\beta_K)]\\
.&.&.&...&.\\
.&.&.&...&.\\
.&.&.&...&.\\
\mathbb{E}[(b_K-\beta_K)(b_0-\beta_0)] & \mathbb{E}[(b_K-\beta_K)(b_1-\beta_1)] & \mathbb{E}[(b_K-\beta_K)(b_2-\beta_2)]&...&\mathbb{E}[(b_K-\beta_K)^2]\\
\end{bmatrix}_{(K \times K)},\\
&=\mathbb{E}
\begin{bmatrix}
[(b_0-\beta_0)^2] & [(b_0-\beta_0)(b_1-\beta_1)] & [(b_0-\beta_0)(b_2-\beta_2)]&...&[(b_0-\beta_0)(b_K-\beta_K)]\\
[(b_1-\beta_1)(b_0-\beta_0)] & [(b_1-\beta_1)^2] & [(b_1-\beta_1)(b_2-\beta_2)]&...&[(b_1-\beta_1)(b_K-\beta_K)]\\
[(b_2-\beta_2)(b_0-\beta_0)] & [(b_2-\beta_2)(b_1-\beta_1)] & [(b_2-\beta_2)^2]&...&[(b_2-\beta_2)(b_K-\beta_K)]\\
.&.&.&...&.\\
.&.&.&...&.\\
.&.&.&...&.\\
[(b_K-\beta_K)(b_0-\beta_0)] & [(b_K-\beta_K)(b_1-\beta_1)] & [(b_K-\beta_K)(b_2-\beta_2)]&...&[(b_K-\beta_K)^2]\\
\end{bmatrix}_{(K \times K)},\\
&=\mathbb{E}[(\bold{b}-\boldsymbol{\beta})(\bold{b}-\boldsymbol{\beta})'],\\
&=\mathbb{E}[\bold{A}\boldsymbol{\varepsilon}\boldsymbol{\varepsilon}'\bold{A}'].
\end{align*}
$$
$$
\begin{align*}
    \mathbb{Var}(\bold{b|X})&=\mathbb{E}[\bold{A}\boldsymbol{\varepsilon}\boldsymbol{\varepsilon'}\bold{A'|X}],\\
    &=\bold{A}\mathbb{E}[\boldsymbol{\varepsilon}\boldsymbol{\varepsilon'}\bold{|X}]\bold{A'}.\\
\end{align*}
$$
Given $\mathbb{E}[\boldsymbol{\varepsilon}]=0$
$$
\begin{align*}
    \mathbb{E}[\boldsymbol{\varepsilon}\boldsymbol{\varepsilon'}]&=\begin{bmatrix}
\mathbb{Var}(\varepsilon_1) & \mathbb{Cov}(\varepsilon_1,\varepsilon_2) & \mathbb{Cov}(\varepsilon_1,\varepsilon_3)&...&\mathbb{Cov}(\varepsilon_1,\varepsilon_n)\\
\mathbb{Cov}(\varepsilon_2,\varepsilon_1) & \mathbb{Var}(\varepsilon_2) & \mathbb{Cov}(\varepsilon_2,\varepsilon_3)&...&\mathbb{Cov}(\varepsilon_2,\varepsilon_n)\\
\mathbb{Cov}(\varepsilon_3,\varepsilon_1) & \mathbb{Cov}(\varepsilon_3,\varepsilon_2) & \mathbb{Var}(\varepsilon_3)&...&\mathbb{Cov}(\varepsilon_3,\varepsilon_n)\\
.&.&.&...&.\\
.&.&.&...&.\\
.&.&.&...&.\\
\mathbb{Cov}(\varepsilon_n,\varepsilon_1) & \mathbb{Cov}(\varepsilon_n,\varepsilon_2) & \mathbb{Cov}(\varepsilon_n,\varepsilon_3)&...&\mathbb{Var}(\varepsilon_n)\\
\end{bmatrix}_{(n \times n)},\\
\mathbb{E}[\boldsymbol{\varepsilon}\boldsymbol{\varepsilon'}\bold{|X}]&=\begin{bmatrix}
\mathbb{Var}(\varepsilon_1|\bold{X}) & \mathbb{Cov}(\varepsilon_1,\varepsilon_2|\bold{X}) & \mathbb{Cov}(\varepsilon_1,\varepsilon_3|\bold{X})&...&\mathbb{Cov}(\varepsilon_1,\varepsilon_n|\bold{X})\\
\mathbb{Cov}(\varepsilon_2,\varepsilon_1|\bold{X}) & \mathbb{Var}(\varepsilon_2|\bold{X}) & \mathbb{Cov}(\varepsilon_2,\varepsilon_3|\bold{X})&...&\mathbb{Cov}(\varepsilon_2,\varepsilon_n|\bold{X})\\
\mathbb{Cov}(\varepsilon_3,\varepsilon_1|\bold{X}) & \mathbb{Cov}(\varepsilon_3,\varepsilon_2|\bold{X}) & \mathbb{Var}(\varepsilon_3|\bold{X})&...&\mathbb{Cov}(\varepsilon_3,\varepsilon_n|\bold{X})\\
.&.&.&...&.\\
.&.&.&...&.\\
.&.&.&...&.\\
\mathbb{Cov}(\varepsilon_n,\varepsilon_1|\bold{X}) & \mathbb{Cov}(\varepsilon_n,\varepsilon_2|\bold{X}) & \mathbb{Cov}(\varepsilon_n,\varepsilon_3|\bold{X})&...&\mathbb{Var}(\varepsilon_n|\bold{X})\\
\end{bmatrix}_{(n \times n)},\\
\mathbb{E}[\boldsymbol{\varepsilon}\boldsymbol{\varepsilon'}\bold{|X}]&=\begin{bmatrix}
    \mathbb{E}(\varepsilon_1^2|\bold{X}) & \mathbb{E}(\varepsilon_1\varepsilon_2|\bold{X}) & \mathbb{E}(\varepsilon_1\varepsilon_3|\bold{X})&...&\mathbb{E}(\varepsilon_1\varepsilon_n|\bold{X})\\
    \mathbb{E}(\varepsilon_2\varepsilon_1|\bold{X}) & \mathbb{E}(\varepsilon_2^2|\bold{X}) & \mathbb{E}(\varepsilon_2\varepsilon_3|\bold{X})&...&\mathbb{E}(\varepsilon_2\varepsilon_n|\bold{X})\\
    \mathbb{E}(\varepsilon_3\varepsilon_1|\bold{X}) & \mathbb{E}(\varepsilon_3\varepsilon_2|\bold{X}) & \mathbb{E}(\varepsilon_3^2|\bold{X})&...&\mathbb{E}(\varepsilon_3\varepsilon_n|\bold{X})\\
    .&.&.&...&.\\
    .&.&.&...&.\\
    .&.&.&...&.\\
    \mathbb{E}(\varepsilon_n\varepsilon_1|\bold{X}) & \mathbb{E}(\varepsilon_n\varepsilon_2|\bold{X}) & \mathbb{E}(\varepsilon_n\varepsilon_3|\bold{X})&...&\mathbb{E}(\varepsilon_n^2|\bold{X})\\
\end{bmatrix}_{(n \times n)}.\\
\end{align*}
$$
Under the assumption of Homoscedasticity $(\mathbb{E}[\varepsilon_i^2\bold{|X}]=\sigma^2)$ and non-autocorrelation $(\mathbb{E}_{i\neq j}[\varepsilon_i\varepsilon_j\bold{|X}]=0)$
$$
\begin{align*}
    \mathbb{E}[\boldsymbol{\varepsilon}\boldsymbol{\varepsilon'}\bold{|X}]&=\sigma^2 \bold{I},\\
    \implies \mathbb{Var}(\bold{b|X})&=\bold{A}\sigma^2 \bold{I}\bold{A'},\\
    &=\bold{(X'X)}^{-1}\bold{X'} \sigma^2 [\bold{(X'X)}^{-1}\bold{X']'},\\
    &=\sigma^2\underbrace{\bold{(X'X)}^{-1}\bold{X'X}}_{1}[\bold{(X'X)}^{-1}]\bold{'},\\
    &=\sigma^2[\bold{(X'X)}^{-1}]\bold{'},\\
    &=\sigma^2[\bold{(X'X)'}]^{-1},\\
    &=\sigma^2\bold{(X'X)}^{-1}.\\
\end{align*}
$$